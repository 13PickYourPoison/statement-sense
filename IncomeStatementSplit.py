import pandas as pd
import re
from io import StringIO

income_statement_raw = """
Services 5,131,403 100.0% 5,109,721 100.0% 4,338,713 100.0% 6,481,838 100.0% 6,451,335 100.1% 6,461,385 100.1%
Services - Drivers Training 6,195 0.1% - 0.0% - 0.0% - 0.0% - 0.0% - 0.0%
Service Refunds (8,692) (0.2%) - 0.0% - 0.0% - 0.0% (5,772) (0.1%) (8,227) (0.1%)
Net Revenue 5,128,906 100.0% 5,109,721 100.0% 4,338,713 100.0% 6,481,838 100.0% 6,445,563 100.0% 6,453,158 100.0%
Cost of Goods Sold
Wages - Drivers 2,049,281 40.0% 2,150,613 42.1% 1,326,983 30.6% 1,880,667 29.0% 1,956,313 30.4% 1,998,155 31.0%
Drivers Gas Reimbursement - 0.0% 286,112 5.6% 146,816 3.4% 250,134 3.9% 364,263 5.7% 302,683 4.7%
Total Cost of Goods Sold 2,049,281 40.0% 2,436,725 47.7% 1,473,799 34.0% 2,130,801 32.9% 2,320,576 36.0% 2,300,838 35.7%
Gross Profit 3,079,625 60.0% 2,672,996 52.3% 2,864,914 66.0% 4,351,037 67.1% 4,124,987 64.0% 4,152,320 64.3%
Operating Expenses
Advertising 2,004 0.0% 2,966 0.1% 500 0.0% - 0.0% - 0.0% 1,294 0.0%
Auto Expense 305,138 5.9% 21,353 0.4% 3,910 0.1% 10,650 0.2% 53,309 0.8% 9,774 0.2%
Auto Maintenance 278,814 5.4% 370,098 7.2% 202,329 4.7% 392,505 6.1% 424,126 6.6% 527,593 8.2%
Contributions 525 0.0% 1,384 0.0% 639 0.0% - 0.0% - 0.0% - 0.0%
Depreciation 130,706 2.5% 221,956 4.3% 112,622 2.6% 167,706 2.6% 268,051 4.2% 164,509 2.5%
Drivers Training 1,898 0.0% - 0.0% - 0.0% - 0.0% - 0.0% - 0.0%
Health and Life Insurance 18,870 0.4% 14,807 0.3% 16,286 0.4% 23,352 0.4% 13,384 0.2% 15,357 0.2%
Insurance - Auto 1,200 0.0% 80,900 1.6% - 0.0% - 0.0% 768 0.0% 917 0.0%
License & Bonds 1,523 0.0% 1,750 0.0% 1,350 0.0% 1,205 0.0% 1,100 0.0% 772 0.0%
Licenses & Permits 15,174 0.3% 25,955 0.5% 9,923 0.2% 23,091 0.4% 14,336 0.2% 16,842 0.3%
Miscellaneous 831 0.0% 15,672 0.3% 11,502 0.3% 35,705 0.6% 7,729 0.1% 15,958 0.2%
Office Expense 31,494 0.6% 32,281 0.6% 19,871 0.5% 12,541 0.2% 18,578 0.3% 11,997 0.2%
Promotion 100 0.0% 9,376 0.2% 4,627 0.1% 5,573 0.1% 4,175 0.1% 3,288 0.1%
Rent 368,871 7.2% 387,470 7.6% 165,744 3.8% 148,613 2.3% 208,873 3.2% 232,339 3.6%
Repairs and Maintenance 566 0.0% 32,425 0.6% 14,464 0.3% 71,009 1.1% 19,759 0.3% 21,185 0.3%
Officer's Compensation 183,000 3.6% 152,000 3.0% 59,356 1.4% - 0.0% 322,349 5.0% 585,462 9.1%
Office Wages 937,236 18.3% 1,176,237 23.0% 828,426 19.1% 913,289 14.1% 556,052 8.6% 596,243 9.2%
Taxes - FICA 245,029 4.8% 251,933 4.9% 140,694 3.2% 196,081 3.0% 209,979 3.3% 218,605 3.4%
Taxes - FUTA 6,955 0.1% 7,371 0.1% 4,500 0.1% 4,920 0.1% 5,003 0.1% 5,153 0.1%
Taxes - SUTA 26,791 0.5% 18,989 0.4% 4,859 0.1% 6,294 0.1% 7,520 0.1% 14,381 0.2%
Taxes - Property - 0.0% 2,871 0.1% 9,147 0.2% 14,179 0.2% 5,970 0.1% 18,294 0.3%
Taxes - Single Business Tax 52,000 1.0% - 0.0% - 0.0% - 0.0% - 0.0% - 0.0%
Utilities - 0.0% 12,930 0.3% 8,112 0.2% 9,003 0.1% 8,420 0.1% 8,180 0.1%
Commission - 0.0% 6,426 0.1% - 0.0% - 0.0% - 0.0% - 0.0%
Dues and Subscriptions - 0.0% 500 0.0% 96,374 2.2% 137,711 2.1% 146,068 2.3% 154,388 2.4%
Telephone - 0.0% 25,266 0.5% 24,833 0.6% 28,532 0.4% 30,685 0.5% 24,348 0.4%
Postage - 0.0% 9,445 0.2% 8,093 0.2% 1,877 0.0% 1,097 0.0% 2,120 0.0%
Payroll Service - 0.0% 7,815 0.2% 9,205 0.2% 7,949 0.1% 10,995 0.2% 11,049 0.2%
Professional Fees - 0.0% (20,613) (0.4%) 25,462 0.6% 33,337 0.5% 9,450 0.1% 18,150 0.3%
Insurance - General - 0.0% - 0.0% 16,911 0.4% 81,337 1.3% 78,246 1.2% 79,645 1.2%
Bank Fees 12 0.0% 12 0.0% - 0.0% 100 0.0% - 0.0% - 0.0%
Company Match - IRA - 0.0% - 0.0% - 0.0% - 0.0% 38,370 0.6% 45,845 0.7%
Corporate Income Tax Provision - 0.0% - 0.0% - 0.0% - 0.0% 103,553 1.6% 81,100 1.3%
Federal Income Tax Provision - 0.0% - 0.0% - 0.0% - 0.0% 338,439 5.3% 266,819 4.1%
Total Expenses 2,608,736 50.9% 2,869,575 56.2% 1,799,739 41.5% 2,326,559 35.9% 2,906,384 45.1% 3,151,607 48.8%
Operating Income 470,889 9.2% (196,579) (3.8%) 1,065,175 24.6% 2,024,478 31.2% 1,218,603 18.9% 1,000,713 15.5%
Other Income (Expense)
Gain/Loss on Equipment Sales (13,436) (0.3%) (12,044) (0.2%) (2,836) (0.1%) (33,355) (0.5%) (1,786) (0.0%) 3,032 0.0%
Interest Income 2,601 0.1% 22,145 0.4% 11,737 0.3% - 0.0% - 0.0% - 0.0%
Other Income - 0.0% - 0.0% - 0.0% - 0.0% 62,000 1.0% - 0.0%
Total Other Income (Expense) (10,835) (0.2%) 10,101 0.2% 8,901 0.2% (33,355) (0.5%) 60,214 0.9% 3,032 0.0%
Net Income 460,054 9.0% (186,478) (3.6%) 1,074,076 24.8% 1,991,123 30.7% 1,278,817 19.8% 1,003,745 15.6%
"""

lines = income_statement_raw.split("\n")
processed_lines = []
pattern = re.compile(r'([A-Za-z\s-]+)((?:\s[\(\)\d,]+(?:\s[\d\.]+%)?)+)')
for line in lines:
    match = pattern.match(line)
    if match:
        category = match.group(1).strip()
        values_str = match.group(2).strip()
        values = [val for val in re.split(r'\s+', values_str) if val]
        processed_lines.append([category] + values)

df = pd.DataFrame(processed_lines)
print(df.head(10))
